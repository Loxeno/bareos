## docker-compose Bareos Director/Storage/Client/webUI and MySQL Database
version: '3'
services:
  bareos-dir:
    build: ./../director-pgsql
    volumes:
      - /data/bareos/config/director:/etc/bareos
      - /data/bareos/data/director:/var/lib/bareos # required for MyCatalog backup
    environment:
      - DB_HOST=bareos-db
      - DB_PORT=3306
      - DB_PASSWORD=ThisIsMySecretDBp4ssw0rd
      - BAREOS_SD_HOST=bareos-sd
      - BAREOS_SD_PASSWORD=ThisIsMySecretSDp4ssw0rd
      - BAREOS_FD_HOST=bareos-fd
      - BAREOS_FD_PASSWORD=ThisIsMySecretFDp4ssw0rd
      - BAREOS_WEBUI_PASSWORD=ThisIsMySecretUIp4ssw0rd
      - SMTP_HOST=smtpd
      #- SENDER_MAIL=your-sender@mail.address #optional
      - ADMIN_MAIL=your@barcus@tou.nu # Change me!
    depends_on:
      - bareos-db

  bareos-sd:
    build: ./../storage
    ports:
      - 9103:9103
    volumes:
      - /data/bareos/config/storage:/etc/bareos
      - /data/bareos/data/storage:/var/lib/bareos/storage
    environment:
      - BAREOS_SD_PASSWORD=ThisIsMySecretSDp4ssw0rd

  bareos-fd:
    build: ./../client
    volumes:
      - /data/bareos/config/client:/etc/bareos
      - /data/bareos/data/director:/var/lib/bareos-director # required for MyCatalog backup
    environment:
      - BAREOS_FD_PASSWORD=ThisIsMySecretFDp4ssw0rd

  bareos-webui:
    build: ./../webui
    ports:
      - 8080:80
    environment:
      - BAREOS_DIR_HOST=bareos-dir
    volumes:
      - /data/bareos/config/webui:/etc/bareos-webui

  # bareos-db:
  #   image: mysql:5.6
  #   volumes:
  #     - /data/mysql/data:/var/lib/mysql
  #   environment:
  #     - MYSQL_ROOT_PASSWORD=ThisIsMySecretDBp4ssw0rd

  bareos-db:
    image: postgres:9.3
    volumes:
      - /data/pgsql/data:/var/lib/postgresql/data
    environment:
      - POSTGRES_PASSWORD=ThisIsMySecretDBp4ssw0rd

  smtpd:
    image: namshi/smtp
#EOF
